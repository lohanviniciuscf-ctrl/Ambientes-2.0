<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRM Premium</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0a192f;
  --card:#112240;
  --accent:#64ffda;
  --text:#e6f1ff;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(135deg,var(--bg),#020c1b);
  color:var(--text);
  transition:.4s;
}

button,input{
  padding:10px;
  border:none;
  border-radius:10px;
  font-family:'Poppins';
}

button{
  cursor:pointer;
  font-weight:600;
  transition:.3s;
}
button:hover{transform:scale(1.05)}

.center{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.box{
  background:var(--card);
  padding:35px;
  border-radius:22px;
  width:380px;
  text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,.45);
  animation:fade .5s;
}

@keyframes fade{
 from{opacity:0;transform:translateY(20px)}
 to{opacity:1}
}

.hidden{display:none}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:25px;
}

.metrics{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:20px;
  margin-bottom:25px;
}

.metric{
  background:var(--card);
  padding:20px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 15px 35px rgba(0,0,0,.25);
  transition:.3s;
}
.metric:hover{transform:translateY(-6px)}

.metric strong{font-size:22px}

.form{
  background:var(--card);
  padding:20px;
  border-radius:20px;
  margin-bottom:25px;
}

.lead{
  background:#fff;
  color:#000;
  padding:18px;
  border-radius:18px;
  margin-bottom:15px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
  transition:.3s;
}
.lead:hover{transform:translateY(-5px)}

.lead small{opacity:.6}

.lead button{
  margin-top:10px;
  margin-right:5px;
  font-size:12px;
  padding:6px 12px;
  border-radius:8px;
}

.btn-edit{
  background:#fde68a;
}
.btn-delete{
  background:#fecaca;
}
</style>
</head>

<body>

<div id="envSelect" class="center">
  <div class="box">
    <h2>üåê Escolha o ambiente</h2><br>
    <button style="background:#e7c09b" onclick="selectEnv('Modelle')">üë©‚Äçü¶∞ Modelle Skin</button><br><br>
    <button style="background:#64ffda" onclick="selectEnv('Cia')">üìí Cia & Arte</button><br><br>
    <button style="background:#7dd3fc" onclick="selectEnv('Thalles')">üå¨Ô∏è Thalles Climatiza√ß√£o</button>
  </div>
</div>

<div id="loginScreen" class="center hidden">
  <div class="box">
    <button onclick="backToEnv()">‚¨Ö Voltar</button>
    <h2 id="envTitle"></h2><br>
    <input id="user" placeholder="Usu√°rio"><br><br>
    <input id="pass" type="password" placeholder="Senha"><br><br>
    <button onclick="login()">Entrar</button>
    <div id="loginError"></div>
  </div>
</div>

<div id="app" class="hidden" style="padding:30px">
<header>
  <h2 id="appTitle"></h2>
  <div>
    <button onclick="exportCSV()">‚¨á CSV</button>
    <button onclick="logout()">Sair</button>
  </div>
</header>

<div id="metrics" class="metrics"></div>
<div class="form" id="formArea"></div>
<div id="lista"></div>
</div>

<script>
/* ===== SEU C√ìDIGO ORIGINAL (INTACTO) ===== */
const users={
 Lohan:{pass:"D9f0da85",env:["Modelle","Cia","Thalles"]},
 Marcus:{pass:"Elistray6001",env:["Cia"]},
 Queila:{pass:"alieuq79",env:["Modelle"]},
 Hamonny:{pass:"climatiza√ß√£o",env:["Thalles"]}
};

let env=null,userAtual=null,pedidos=[];

/* ... TODO O SEU SCRIPT ORIGINAL PERMANECE IGUAL ... */

/* ===== INTEGRA√á√ÉO GOOGLE SHEETS (ADICIONADO) ===== */

const SHEETS_URL="https://script.google.com/macros/s/AKfycbwXwf9JUZYOKDCADNQdhBqyt8dWIeHXSGttYrFFb_gQ5JijANGZL_rsxOis8snaxQUX/exec";

async function sheetsSave(){
 await fetch(SHEETS_URL,{
  method:"POST",
  headers:{ "Content-Type":"application/json" },
  body:JSON.stringify({ env,user:userAtual,pedidos })
 });
}

async function sheetsLoad(){
 const r=await fetch(`${SHEETS_URL}?env=${env}`);
 pedidos=await r.json()||[];
}

const _login=login;
login=async function(){
 _login();
 if(app.classList.contains("hidden")) return;
 await sheetsLoad();
 render();
};

const _add=addPedido;
addPedido=async function(){
 _add();
 await sheetsSave();
};

const _edit=editPedido;
editPedido=async function(id){
 _edit(id);
 await sheetsSave();
};

const _del=deletePedido;
deletePedido=async function(id){
 _del(id);
 await sheetsSave();
};
</script>

</body>
</html>
