<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRM</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0a192f;
  --card:#112240;
  --accent:#64ffda;
  --text:#e6f1ff;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Poppins', sans-serif;
  background:var(--bg);
  color:var(--text);
}

button,input{
  padding:10px;
  border:none;
  border-radius:8px;
  font-family:'Poppins';
}

button{
  cursor:pointer;
  font-weight:600;
}

.center{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.box{
  background:var(--card);
  padding:30px;
  border-radius:18px;
  width:360px;
  text-align:center;
  box-shadow:0 20px 50px rgba(0,0,0,.4);
}

.hidden{display:none}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}

.metrics{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:15px;
  margin-bottom:20px;
}

.metric{
  background:var(--card);
  padding:15px;
  border-radius:16px;
  text-align:center;
}

.metric strong{font-size:20px}

.form{
  background:var(--card);
  padding:15px;
  border-radius:16px;
  margin-bottom:20px;
}

.lead{
  background:#fff;
  color:#000;
  padding:15px;
  border-radius:14px;
  margin-bottom:12px;
  box-shadow:0 6px 15px rgba(0,0,0,.15);
}

.lead small{opacity:.6}

.lead button{
  margin-top:8px;
  margin-right:5px;
  font-size:12px;
  padding:6px 10px;
}
</style>
</head>

<body>

<!-- AMBIENTE -->
<div id="envSelect" class="center">
  <div class="box">
    <h2>Escolha o ambiente</h2>
    <button style="background:#e2b48c" onclick="selectEnv('Modelle Skin')">Modelle Skin</button><br><br>
    <button style="background:#64ffda" onclick="selectEnv('Cia & Arte')">Cia & Arte</button>
  </div>
</div>

<!-- LOGIN -->
<div id="loginScreen" class="center hidden">
  <div class="box">
    <button onclick="backToEnv()">⬅ Voltar</button>
    <h2 id="envTitle"></h2>
    <input id="user" placeholder="Usuário"><br>
    <input id="pass" type="password" placeholder="Senha"><br><br>
    <button onclick="login()">Entrar</button>
    <div id="loginError"></div>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden" style="padding:25px">
<header>
  <h2 id="appTitle"></h2>
  <div>
    <button onclick="exportCSV()">⬇ CSV</button>
    <button onclick="logout()">Sair</button>
  </div>
</header>

<div class="metrics" id="metrics"></div>

<div class="form">
  <input id="desc" placeholder="Descrição" style="width:100%"><br><br>
  <input id="valor" type="number" placeholder="Valor" style="width:100%"><br><br>
  <button onclick="addPedido()">Adicionar</button>
</div>

<div id="lista"></div>
</div>

<script>
const users={
 Lohan:{pass:"D9f0da85",env:["Modelle Skin","Cia & Arte"]},
 marcus:{pass:"Elistray6001",env:["Cia & Arte"]},
 Queila:{pass:"alieuq79",env:["Modelle Skin"]}
};

let env=null,userAtual=null,pedidos=[];

function themeModelle(){
 document.documentElement.style.setProperty("--bg","#f6e2cf");
 document.documentElement.style.setProperty("--card","#e7c09b");
 document.documentElement.style.setProperty("--accent","#c58c5e");
 document.documentElement.style.setProperty("--text","#000");
}

function selectEnv(e){
 env=e;
 envSelect.classList.add("hidden");
 loginScreen.classList.remove("hidden");
 envTitle.innerText=e;
}

function backToEnv(){
 loginScreen.classList.add("hidden");
 envSelect.classList.remove("hidden");
}

function login(){
 if(users[user.value] && users[user.value].pass===pass.value && users[user.value].env.includes(env)){
  userAtual=user.value;
  loginScreen.classList.add("hidden");
  app.classList.remove("hidden");
  appTitle.innerText=env+" — "+userAtual;
  if(env==="Modelle Skin") themeModelle();
  pedidos=JSON.parse(localStorage.getItem(env+"_"+userAtual))||[];
  render();
 }else loginError.innerText="Login inválido";
}

function logout(){location.reload()}

function save(){
 localStorage.setItem(env+"_"+userAtual,JSON.stringify(pedidos));
}

function addPedido(){
 pedidos.push({id:Date.now(),desc:desc.value,valor:+valor.value,data:Date.now()});
 save();render();
}

function render(){
 let total=0;
 pedidos.forEach(p=>total+=p.valor);
 let comissao=(env==="Modelle Skin")?(total*0.01):0;

 metrics.innerHTML=`
  <div class="metric">Pedidos<br><strong>${pedidos.length}</strong></div>
  <div class="metric">Total<br><strong>R$ ${total.toFixed(2)}</strong></div>
  ${env==="Modelle Skin"
   ?`<div class="metric">Comissão (1%)<br><strong>R$ ${comissao.toFixed(2)}</strong></div>`
   :``}
 `;

 lista.innerHTML="";
 pedidos.forEach(p=>{
  lista.innerHTML+=`
   <div class="lead">
    <strong>${p.desc}</strong><br>
    R$ ${p.valor}<br>
    <small>${new Date(p.data).toLocaleDateString()}</small>
   </div>
  `;
 });
}

function exportCSV(){
 let csv="Descrição,Valor,Data\n";
 pedidos.forEach(p=>{
  csv+=`${p.desc},${p.valor},${new Date(p.data).toLocaleDateString()}\n`;
 });
 const blob=new Blob([csv],{type:"text/csv"});
 const a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download=env+"_consolidado.csv";
 a.click();
}
</script>

</body>
</html>
